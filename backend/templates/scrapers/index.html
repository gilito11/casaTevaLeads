{% extends 'base.html' %}

{% block title %}Scrapers - FincaRadar{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Scrapers</h1>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
                Configura las zonas y ejecuta los scrapers de portales inmobiliarios
            </p>
        </div>
    </div>

    <!-- Info: Scraping automatico -->
    <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4">
        <div class="flex items-start space-x-3">
            <svg class="w-5 h-5 text-green-600 dark:text-green-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <div>
                <p class="font-medium text-green-800 dark:text-green-300">Scraping automatico activo</p>
                <p class="text-sm text-green-700 dark:text-green-400">El scraping se ejecuta automaticamente a las 12:00 y 18:00 (hora Espana).</p>
            </div>
        </div>
    </div>

    <!-- Messages -->
    {% if messages %}
    <div class="space-y-2">
        {% for message in messages %}
        <div class="p-4 rounded-lg {% if message.tags == 'success' %}bg-green-50 text-green-800 dark:bg-green-900/50 dark:text-green-400{% elif message.tags == 'error' %}bg-red-50 text-red-800 dark:bg-red-900/50 dark:text-red-400{% elif message.tags == 'warning' %}bg-yellow-50 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-400{% else %}bg-blue-50 text-blue-800 dark:bg-blue-900/50 dark:text-blue-400{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% include 'scrapers/partials/zonas_panels.html' %}

    <!-- Scrapers Info -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700">
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Scrapers Disponibles</h2>
            <p class="text-sm text-gray-500 dark:text-gray-400">Portales inmobiliarios soportados</p>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                {% for scraper in scrapers %}
                <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-600">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center
                            {% if scraper.id == 'milanuncios' %}bg-blue-100 text-blue-600
                            {% elif scraper.id == 'habitaclia' %}bg-teal-100 text-teal-600
                            {% elif scraper.id == 'pisos' %}bg-orange-100 text-orange-600
                            {% else %}bg-purple-100 text-purple-600{% endif %}">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="font-medium text-gray-900 dark:text-white">{{ scraper.nombre }}</h3>
                            <p class="text-xs text-gray-500 dark:text-gray-400">{{ scraper.descripcion }}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Instructions -->
    <div class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6">
        <h3 class="font-medium text-blue-800 dark:text-blue-400 mb-2">Como usar</h3>
        <ol class="list-decimal list-inside text-sm text-blue-700 dark:text-blue-300 space-y-1">
            <li>Anade las zonas geograficas que quieres scrapear desde "Zonas Disponibles"</li>
            <li>El scraping se ejecutara automaticamente a las 12:00 y 18:00</li>
            <li>Los leads encontrados apareceran automaticamente en la seccion de Leads</li>
        </ol>
        <p class="mt-3 text-xs text-blue-600 dark:text-blue-400">
            <strong>Nota:</strong> Los nuevos leads pueden tardar unos minutos en aparecer tras el scraping.
        </p>
    </div>
</div>
{% endblock %}
