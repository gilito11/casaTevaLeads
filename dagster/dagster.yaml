# Dagster 1.5.x configuration for Casa Teva Lead System
# Uses PostgreSQL for persistent storage (survives container restarts)

# Run storage - stores run metadata
run_storage:
  module: dagster_postgres.run_storage
  class: PostgresRunStorage
  config:
    postgres_url:
      env: DATABASE_URL

# Event log storage - stores asset materializations and run events
event_log_storage:
  module: dagster_postgres.event_log
  class: PostgresEventLogStorage
  config:
    postgres_url:
      env: DATABASE_URL

# Schedule storage - stores schedule state and tick history (CRITICAL for schedule to work)
schedule_storage:
  module: dagster_postgres.schedule_storage
  class: PostgresScheduleStorage
  config:
    postgres_url:
      env: DATABASE_URL

# Run launcher config
run_launcher:
  module: dagster._core.launcher.default_run_launcher
  class: DefaultRunLauncher

# Run coordinator - limit concurrent runs to avoid resource issues
run_coordinator:
  module: dagster._core.run_coordinator
  class: QueuedRunCoordinator
  config:
    max_concurrent_runs: 1

# Disable telemetry
telemetry:
  enabled: false
